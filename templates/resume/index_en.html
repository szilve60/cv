<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>{{ profile.name }} — CV (EN)</title>
    <link rel="stylesheet" href="/static/resume/style.css">
  </head>
  <body>
    <header class="site-header" role="banner">
      <a class="brand-btn" href="/">Szilveszter.</a>
      <div class="top-center-ctas">
        <a class="btn primary" href="#about">About.</a>
        <a class="btn outline" href="/">Magyar</a>
      </div>
    </header>

    {% if profile %}
    <div class="cv-wrap hero">
      <div class="hero-left">
        <h1 class="hero-name">{{ profile.name }}</h1>
        <h2 class="hero-role">{{ profile.title_en|default:profile.title }}</h2>

        <div class="hero-summary">
          {% if profile.summary_en %}
            {% for line in profile.summary_en.splitlines %}
              <p>{{ line }}</p>
            {% endfor %}
          {% else %}
            {% for line in profile.summary.splitlines %}
              <p>{{ line }}</p>
            {% endfor %}
          {% endif %}
        </div>

        <div class="hero-links">
          {% if profile.linkedin %}
            <a class="social" href="{{ profile.linkedin }}" target="_blank" rel="noopener">LinkedIn</a>
          {% endif %}
        </div>
      </div>

      <div class="hero-right" role="img" aria-label="profile portrait">
        <img src="/static/resume/profile.png" alt="profile portrait">
      </div>
    </div>

    <section class="yellow-band" aria-hidden="false">
      <div class="yellow-inner">
        <div class="separator">About.</div>

        <div class="exp-band">
          <div class="exp-inner">
            <div class="card card-experience exp-card-top">
              <h3>Experience</h3>
              <ul>
                {% for e in profile.experiences.all %}
                  <li>
                    <strong>{{ e.role_en|default:e.role }}</strong>{% if e.role_en %}<span class="used-indicator"> (EN)</span>{% endif %} — {{ e.company_en|default:e.company }}{% if e.company_en %}<span class="used-indicator"> (EN)</span>{% endif %} <span class="dates">({{ e.start }} - {{ e.end }})</span>
                    <div class="desc">{{ e.description_en|default:e.description }}{% if e.description_en %}<span class="used-indicator"> (EN desc)</span>{% endif %}</div>
                  </li>
                {% empty %}
                  <li>Not provided</li>
                {% endfor %}
              </ul>
            </div>
          </div>
        </div>

        <section id="about" class="about-section">
          <div class="about-cards">
        <div class="card card-education">
          <h3>Education</h3>
          <ul>
            {% for ed in profile.education.all %}
              <li><strong>{{ ed.degree_en|default:ed.degree }}</strong> — {{ ed.institution_en|default:ed.institution }} <span class="dates">({{ ed.year }})</span></li>
            {% empty %}
              <li>Not provided</li>
            {% endfor %}
          </ul>
        </div>

        <div class="card card-skills">
          <h3>Skills</h3>
          <ul class="skills-list">
            {% for s in profile.skills.all %}
              <li class="skill-pill">{{ s.name_en|default:s.name }}{% if s.level %} — {{ s.level }}{% endif %}</li>
            {% empty %}
              <li>Not provided</li>
            {% endfor %}
          </ul>
        </div>

        <div class="card card-programming">
          <h3>Software & Programming</h3>
          <ul class="prog-list">
            {% for p in profile.programming_skills.all %}
              <li>
                <div class="prog-row">
                  <strong class="lang">{{ p.language_en|default:p.language }}</strong>
                  <div class="prog-bar" data-level="{{ p.level }}">
                    <div class="fill"></div>
                  </div>
                </div>
              </li>
            {% empty %}
              <li>Not provided</li>
            {% endfor %}
          </ul>
        </div>


          </div>
        </section>
      </div>
    </section>
    <script>
      // Animate programming skill bars on DOMContentLoaded (same as main page)
      document.addEventListener('DOMContentLoaded', function () {
        const bars = Array.from(document.querySelectorAll('.card-programming .prog-bar'));
        bars.forEach((bar, i) => {
          const lvl = parseInt(bar.dataset.level || '0', 10);
          const fill = bar.querySelector('.fill');
          if (!fill) return;
          const delay = 120 * i + 60;
          setTimeout(() => {
            const pct = Math.max(0, Math.min(5, lvl)) / 5 * 100;
            fill.style.width = pct + '%';
          }, delay);
        });
      });
    </script>
    <script>
      // Ensure yellow band visible and sized
      function adjustYellowBand() {
        const hero = document.querySelector('.cv-wrap.hero');
        const band = document.querySelector('.yellow-band');
        if (!hero || !band) return;
        const heroRect = hero.getBoundingClientRect();
        const remaining = window.innerHeight - heroRect.height;
        band.style.minHeight = Math.max(320, remaining) + 'px';
      }
      window.addEventListener('load', adjustYellowBand);
      window.addEventListener('resize', adjustYellowBand);
      document.addEventListener('DOMContentLoaded', adjustYellowBand);
    </script>
    <script>
      // Lazy reveal for about cards
      document.addEventListener('DOMContentLoaded', function () {
        const cards = Array.from(document.querySelectorAll('.about-cards .card'));
        if (!('IntersectionObserver' in window)) { cards.forEach(c => c.classList.add('revealed')); return; }
        const io = new IntersectionObserver((entries, obs) => {
          entries.forEach(entry => {
            if (entry.isIntersecting) { entry.target.classList.add('revealed'); obs.unobserve(entry.target); }
          });
        }, {root:null, rootMargin:'0px 0px -10% 0px', threshold: 0.12});
        cards.forEach((c,i)=>{ c.style.transitionDelay = (i*120)+'ms'; io.observe(c); });
      });
    </script>
    <script>
      // Simple initial reveal: show the yellow band immediately on English page
      document.addEventListener('DOMContentLoaded', function(){
        const band = document.querySelector('.yellow-band');
        if(band) band.classList.add('visible');
      });
    </script>

    <script>
      // If user clicks the "Magyar" link, clear the cv_lang cookie so root shows Hungarian
      document.addEventListener('DOMContentLoaded', function(){
        const back = document.querySelector('.site-header .top-center-ctas a[href="/"]');
        if(!back) return;
        back.addEventListener('click', function(e){
          // remove cookie then proceed
          document.cookie = 'cv_lang=; Path=/; Expires=Thu, 01 Jan 1970 00:00:01 GMT;';
        });
      });
    </script>
    {% else %}
      <p style="padding:20px">No profile found. Create one in the admin panel.</p>
    {% endif %}
  </body>
</html>
